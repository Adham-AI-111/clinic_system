{% extends 'main.html' %}
{% block title %}تفاصيل الموعد{% endblock %}
{% block content %}

<div class="layout">
    <!-- TODO: display for staff only -->
    {% include 'sidebar.html' %}
    <!-- ---------------------------- -->

    <main class="content">
        <section class="section">
            <!--? public appointment data -->
            <div class="card">
                <h1 style="margin:0 0 8px;">موعد — {{user.username}} </h1>
                <p style="margin:0; color:var(--muted);">{{appointment.date|date:'d-m-Y'}} • الرسوم: {{appointment.cost}} ج.م</p>
            </div>
            <!-- ----------------------- -->

            <!-- ! ====== DIAGNOSIS ======= -->
             {% if not diagnosis %}
            <div id="form-section">
                <!-- ? solve the issue that was happend after cancled the form, that make the add button disappeard by hx-on and some thing in cancel button-->
                <div id="add-diagnosis-btn" {% if diagnosis %}style="display:none;"{% endif %}>
                    <button
                        hx-get="{% url 'add-diagnosis' appoint_id=appointment.id %}" 
                        hx-target="#diagnosis-form"
                        hx-swap="beforeend"
                        hx-on="click: this.parentElement.style.display='none'"
                    >+ add diagnosis</button>
                </div>
                <div id="diagnosis-form"></div>
            </div>
            {% endif %}

            <div>
                <div>
                    <!--? the diagnosis -->
                    <div class="card" id="diagnosis-card-container">
                        <!-- Diagnosis will be displayed here -->
                         {% if diagnosis %}
                         {% include 'patient/partials/diagnosis_view.html' %}
                         {% endif %}
                    </div>
                </div>
            </div>
            <!-- -------------- -->
            
            <!-- !======= PRESCRIPTION ========= -->
            <div>
                <button>+ add prescription</button>
            </div>
            <div>
                <!--? the prescription -->
                <div class="card" id="prescription-card-container">
                    <div id="prescription-data">
                        <h2 style="margin-top:0;">الوصفة الطبية</h2>
                        <ul style="margin:0; padding:0 20px;">
                            <li>أموكسيسيلين 500 مجم — حبة كل 8 ساعات لمدة 7 أيام</li>
                            <li>باراسيتامول 500 مجم — حبتان عند الحاجة للألم أو الحمى</li>
                            <li>غرغرة ماء مالح — 3 مرات يوميًا</li>
                        </ul>
                    </div>
                    <div>
                        <button>Upadte</button>
                    </div>
                </div>
            </div>


            <!-- !======== REQUIREMENTS ======== -->
            <div>
                <button>+ add advices</button>
            </div>
            <div>
                <!--? advices -->
                <div class="card" id="required-card-container">
                    <div id="required-data">
                        <h2 style="margin-top:0;">نصائح عامة</h2>
                        <ul style="margin:0; padding:0 20px;">
                            <li>الراحة التامة لمدة يومين</li>
                            <li>شرب السوائل الدافئة بكثرة</li>
                            <li>تجنب الأطعمة الحارة والباردة</li>
                            <li>متابعة بعد أسبوع إذا لم تتحسن الأعراض</li>
                        </ul>
                    </div>

                    <div>
                        <button>Upadte</button>
                    </div>
                </div>
            </div>
            <!-- ------------------ -->

            <div style="display:flex; gap:12px;">
                <a href="{% url 'patient-profile' user.id %}" class="btn">العودة إلى profile</a>
            </div>
        </section>
    </main>
</div>
{% endblock %}